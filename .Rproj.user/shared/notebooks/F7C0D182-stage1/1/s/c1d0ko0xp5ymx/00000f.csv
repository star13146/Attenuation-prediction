"0","library(ggplot2)"
"0","library(gridExtra)  # or library(patchwork)"
"0",""
"0","plot_feature_selection <- function(rfl_table, fso_table, rfl_threshold = NULL, fso_threshold = NULL, title = ""Feature Selection Performance"") {"
"0","  "
"0","  plot_rfl <- ggplot(rfl_table, aes(x = Removed_Feature)) +"
"0","    geom_line(aes(y = RMSE, color = ""RMSE"")) +"
"0","    geom_line(aes(y = R2, color = ""R2"")) +"
"0","    scale_y_continuous("
"0","      name = ""Value"","
"0","      sec.axis = dup_axis(name = ""R2 (Secondary)"")"
"0","    ) +"
"0","    labs(title = ""RFL Feature Selection"", x = ""Removed Feature"") +"
"0","    scale_color_manual(values = c(""RMSE"" = ""blue"", ""R2"" = ""red"")) +"
"0","    theme_minimal()"
"0",""
"0","  if (!is.null(rfl_threshold)) {"
"0","    plot_rfl <- plot_rfl +"
"0","      geom_vline(xintercept = rfl_threshold, linetype = ""dashed"", color = ""black"")"
"0","  }"
"0",""
"0","  plot_fso <- ggplot(fso_table, aes(x = Removed_Feature)) +"
"0","    geom_line(aes(y = RMSE, color = ""RMSE"")) +"
"0","    geom_line(aes(y = R2, color = ""R2"")) +"
"0","    scale_y_continuous("
"0","      name = ""Value"","
"0","      sec.axis = dup_axis(name = ""R2 (Secondary)"")"
"0","    ) +"
"0","    labs(title = ""FSO Feature Selection"", x = ""Removed Feature"") +"
"0","    scale_color_manual(values = c(""RMSE"" = ""blue"", ""R2"" = ""red"")) +"
"0","    theme_minimal()"
"0",""
"0","  if (!is.null(fso_threshold)) {"
"0","    plot_fso <- plot_fso +"
"0","      geom_vline(xintercept = fso_threshold, linetype = ""dashed"", color = ""black"")"
"0","  }"
"0",""
"0","  grid.arrange(plot_rfl, plot_fso, ncol = 2, top = title)"
"0","}"
"0",""
